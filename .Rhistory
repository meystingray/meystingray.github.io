}
x <- x[stream > minStream & !is.na(stream) & !is.infinite(stream)]
stream <- stream[stream > minStream & !is.na(stream) & !is.infinite(stream)]
if (SmoothStrength < 1) {
SmoothStrength <- round(len*(1 - ((1 - 0.7)*SmoothStrength + 0.7)),digits = 0)
} else {
SmoothStrength <- 2
}
SmoothStream <- predict(smooth.spline(x = x,y = stream,df = SmoothStrength,
keep.data = FALSE))$y
SmoothStream[SmoothStream < 0] <- 1
SmoothStream <- merge(x = data.frame(x = 1:len),
y = data.frame(x = x,
SmoothStream = SmoothStream),
by = 'x',all.x = TRUE)$SmoothStream
SmoothStream <- na.lomf(SmoothStream)
#plot(x,WATER)
#lines(x,SmoothWater,col = "Red")
return(SmoothStream)
} else { # No smoothing
return(stream)
}
}
Murder[,NumPerDay := .N,by = Date]
Murder[,SmoothNumPerDay := SmoothStream(NumPerDay)]
Murder[,SmoothNumPerDay := smooth.spline(NumPerDay)]
smooth.spline(Murder$NumPerDay)
predict(smooth.spline(Murder$NumPerDay))
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay))]
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay))]
Murder[,.(predict(smooth.spline(NumPerDay)))]
predict(smooth.spline(Murder$NumPerDay))
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay))$y]
plot(Murder[,.N,by = Date])
lines(Murder$SmoothNumPerDay,col = "red")
Murder$SmoothNumPerDay
lines(Murder$Date,Murder$SmoothNumPerDay,col = "red")
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay,df = 10))$y]
plot(Murder[,.N,by = Date])
lines(Murder$Date,Murder$SmoothNumPerDay,col = "red")
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay,df = 20))$y]
plot(Murder[,.N,by = Date])
lines(Murder$Date,Murder$SmoothNumPerDay,col = "red")
Murder[,MonthDate := as.Date(paste0(format(Date,"%Y-%m"),"-01"))]
Murder[,NumPerMonth := .N,by = MonthDate]
Murder[,SmoothNumPerMonth := predict(smooth.spline(NumPerMonth,df = 10))$y]
plot(Murder[,.N,by = MonthDate])
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
unique(Murder$offincident)
Murder <- PI[grepl("MURDER",offincident) | grepl("HOMICIDE",offincident),]
unique(Murder$offincident)
Murder[,MonthDate := as.Date(paste0(format(Date,"%Y-%m"),"-01"))]
setorder(Murder,Date)
Murder[,NumPerDay := .N,by = Date]
Murder[,NumPerMonth := .N,by = MonthDate]
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay,df = 20))$y]
Murder[,SmoothNumPerMonth := predict(smooth.spline(NumPerMonth,df = 10))$y]
plot(Murder[,.N,by = Date])
lines(Murder$Date,Murder$SmoothNumPerDay,col = "red")
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
install.packages("ggplot2")
library(ggplot2)
ggplot2(Murder) + geom_line(aes(x = MonthDate,y = SmoothNumPerMonth,color = offincident))
library(ggplot2)
ggplot2(Murder) + geom_line(aes(x = MonthDate,y = SmoothNumPerMonth,color = offincident))
ggplot(Murder) + geom_line(aes(x = MonthDate,y = SmoothNumPerMonth,color = offincident))
ggplot(Murder) + geom_line(aes(x = MonthDate,y = SmoothNumPerMonth,color = offincident)) + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,color = offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,color = offincident)) + geom_bar()
ggplot(Murder,aes(x = MonthDate,color = offincident)) + geom_bar()
ggplot(Murder,aes(x = MonthDate)) + geom_bar()
ggplot(Murder,aes(x = MonthDate)) + geom_bar() + geom_line()
ggplot(Murder,aes(x = MonthDate)) + geom_bar()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point()
ggplot(Murder,aes(x = Date,y = NumPerDay,color = offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = Date,y = NumPerDay,color = offincident)) + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,trellis = offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,facets = offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,facets = offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,facets = . ~ offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth,facets = offincident)) + geom_line() + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point() + facet_wrap(~ offincident)
ggplot(Murder,aes(x = victimrace)) + geom_bar()
unique(Murder$victimtype)
View(Murder)
ggplot(Murder,aes(x = compmrace)) + geom_bar()
ggplot(Murder,aes(x = comprace)) + geom_bar()
remove.packages("blogdown")
install.packages("blogdown")
library(blogdown)
blogdown::new_site(dir = "C:/Users/sconroy/Documents/meystingray.github.io")
unlink('~/meystingray.github.io/content/post/2020-11-25 Test_cache', recursive = TRUE)
blogdown::new_post(title = "Test123")
library(blogdown)
blogdown::new_site(dir = "C:/Users/sconroy/Documents/meystingray.github.io")
blogdown::new_post(title = "Test123")
install.packages("shiny")
install.packages("miniUI")
blogdown:::new_post_addin()
blogdown:::preview_site(startup = TRUE)
getwd()
setwd("C:/Users/sconroy/Documents/meystingray.github.io")
blogdown::new_post(title = "Test1234")
blogdown:::new_post_addin()
PI <- readRDS("C:/Users/sconroy/Desktop/Debug/PoliceIncidents.RDS")
library(data.table)
setDT(PI)
# We extract murder incidents by looking for "MURDER" or "HOMICIDE" in the officer's incident description.
Murder <- PI[grepl("MURDER",offincident) | grepl("HOMICIDE",offincident),]
Murder[,Date := as.Date(substr(date1,1,10))]
# Clean Up Data
Murder[,MonthDate := as.Date(paste0(format(Date,"%Y-%m"),"-01"))]
setorder(Murder,Date)
Murder[,NumPerDay := .N,by = Date]
Murder[,NumPerMonth := .N,by = MonthDate]
Murder[,SmoothNumPerDay := predict(smooth.spline(NumPerDay,df = 20))$y]
Murder[,SmoothNumPerMonth := predict(smooth.spline(NumPerMonth,df = 10))$y]
# Plot
plot(Murder[,.N,by = Date])
# Plot
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point() + facet_wrap(~ offincident)
library(ggplot2)
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point() + facet_wrap(~ offincident)
unique(Murder$offincident)
table(Murder$offincident)
ggplot(Murder[!(offincident %in% c("CAPITAL MURDER WHILE REMUNERATION","CRIMINAL NEGLIGENT HOMICIDE (DISTRACTED DRIVING"))],
aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point() + facet_wrap(~ offincident)
ggplot(Murder,aes(x = Date,y = NumPerDay,color = offincident)) + geom_point()
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point()
# Plot Num of Murders per Month
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() + geom_point()
# Plot Num of Murders per Month
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() +
geom_point(data = Murder,aes(x = Date,y = NumPerMonth))
# Plot Num of Murders per Month
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
ggplot(Murder,aes(x = MonthDate)) + geom_bar()
ggplot(Murder,aes(x = comprace)) + geom_bar()
unique(Murder$victimtype)
unique(Murder$comprace)
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10))
library(stringr)
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10))
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race")
ggplot(Murder,aes(x = MonthDate)) + geom_bar()
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar()
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() + ylab("# Murders per Month")
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() + ylab("# Murders per Month") +
geom_text(aes(label = Number), position = position_dodge(width = 0.9), vjust = -0.25)
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar(stat="identity") +
ylab("# Murders per Month") +
geom_text(aes(x = MonthDate,label = y))#, position = position_dodge(width = 0.9), vjust = -0.25)
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar(stat="identity") +
ylab("# Murders per Month") +
geom_text(aes(x = MonthDate,label = NumPerMonth))#, position = position_dodge(width = 0.9), vjust = -0.25)
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar(stat="identity") +
ylab("# Murders per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth))#, position = position_dodge(width = 0.9), vjust = -0.25)
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() +
ylab("# Murders per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth))#, position = position_dodge(width = 0.9), vjust = -0.25)
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() +
ylab("# Murders per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth),vjust = -0.25)
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() +
ylab("# Murders per Month") + ggtitle("2020 Murders Per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth),vjust = -0.25) +
#, position = position_dodge(width = 0.9), vjust = -0.25)
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race")
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() +
ylab("# Murders per Month") + ggtitle("2020 Murders Per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth),vjust = -0.25)
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race")
# Plot 2020 Only Murder Rate per Month
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() +
ylab("# Murders per Month") + ggtitle("2020 Murders Per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth),vjust = -0.25)
# Plot Num of Murders per Month
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line() +
geom_point(data = Murder,aes(x = Date,y = NumPerMonth))
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line(color = "red") +
geom_point(data = Murder,aes(x = Date,y = NumPerMonth))
# Plot Num of Murders per Month
plot(Murder[,.N,by = MonthDate])
lines(Murder$MonthDate,Murder$SmoothNumPerMonth,col = "red")
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line(color = "red") +
geom_point(data = Murder,aes(x = Date,y = NumPerMonth))
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line(color = "red") +
geom_point(data = Murder,aes(x = Date,y = NumPerMonth)) + ggtitle("2020 Murders Per Month")
ggplot(Murder,aes(x = MonthDate,y = SmoothNumPerMonth)) + geom_line(color = "red") +
geom_point(data = Murder,aes(x = Date,y = NumPerMonth)) + ggtitle("Murder Rate Per Month")
# Victim Rate per Race
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race")
# Victim Rate per Race
Murder[,NumPerRace := .N,by = comprace]
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race") + geom_text(aes(x = comprace,y = NumPerRace,label = NumPerRace),vjust = -0.25)
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race") + geom_text(aes(x = comprace,y = NumPerRace,label = NumPerRace),vjust = -0.25) +
+ ggtitle("Victim Count by Race")
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race") + geom_text(aes(x = comprace,y = NumPerRace,label = NumPerRace),vjust = -0.25) +
ggtitle("Victim Count by Race")
# Plot 2020 Only Murder Rate per Month
ggplot(Murder[Date > as.Date("2020-01-01"),],aes(x = MonthDate)) + geom_bar() +
ylab("# Murders per Month") + ggtitle("2020 Murders Per Month") +
geom_text(aes(x = MonthDate,y = NumPerMonth,label = NumPerMonth),vjust = -0.25)
unique(Murder$watch)
# Victim Rate per Watch
Murder[,NumPerWatch := .N,by = watch]
ggplot(Murder,aes(x = watch)) + geom_bar() +
xlab("") + ylab("# per Watch") + geom_text(aes(x = watch,y = NumPerWatch,label = NumPerWatch),vjust = -0.25) +
ggtitle("Murder Rate per Watch")
Murder[watch == 1,Shift = "11pm - 7am"]
Murder[watch == 2,Shift = "7am - 3pm"]
Murder[watch == 1,Shift := "11pm - 7am"]
Murder[watch == 2,Shift := "7am - 3pm"]
Murder[watch == 3,Shift := "3pm - 11pm"]
ggplot(Murder,aes(x = Shift)) + geom_bar() +
xlab("") + ylab("# per Shift") + geom_text(aes(x = Shift,y = NumPerWatch,label = NumPerWatch),vjust = -0.25) +
ggtitle("Murder Rate per Shift")
Murder$Shift <- factor(Murder$Shift,levels = c("11pm - 7am", "7am - 3pm", "3pm - 11pm"))
ggplot(Murder,aes(x = Shift)) + geom_bar() +
xlab("") + ylab("# per Shift") + geom_text(aes(x = Shift,y = NumPerWatch,label = NumPerWatch),vjust = -0.25) +
ggtitle("Murder Rate per Shift")
unique(Murder$signal)
table(Murder$signal)
barplot(table(Murder$signal))
Murder[,NumPerSignal := .N,by = signal]
ggplot(Murder,aes(x = Shift)) + geom_bar() +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder,aes(x = Shift)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 1,],aes(x = Shift)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 2,],aes(x = Shift)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 5,],aes(x = Shift)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 5,],aes(x = Shift,y = reorder(NumPerSignal, -NumPerSignal))) + geom_bar() +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 5,],aes(x = reorder(signal, -NumPerSignal))) + geom_bar() +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 3,],aes(x = reorder(signal, -NumPerSignal))) + geom_bar() +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
ggplot(Murder[NumPerSignal > 5,],aes(x = reorder(signal, -NumPerSignal))) + geom_bar() +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Signal") + geom_text(aes(x = signal,y = NumPerSignal,label = NumPerSignal),vjust = -0.25) +
ggtitle("Murder Rate per Signal")
unique(Murder$signal)
Murder[signal == "19 - SHOOTING",NumShootingsPerYear := .N,by = servyr]
ggplot(Murder,aes(x = comprace)) + geom_bar() + scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Victim Race") + geom_text(aes(x = comprace,y = NumPerRace,label = NumShootingsPerYear),
vjust = -0.25) +
ggtitle("Num Shootings Per Year")
ggplot(Murder[signal == "19 - SHOOTING",],aes(x = servyr)) + geom_bar() +
xlab("") + ylab("# per year") + geom_text(aes(x = servyr,y = NumShootingsPerYear,label = NumShootingsPerYear),
vjust = -0.25) +
ggtitle("Num Shootings Per Year")
unique(Murder$premise)
unique(Murder$objattack)
Murder[,NumPerAttack := .N,by = objattack]
ggplot(Murder[NumPerAttack > 5,],aes(x = reorder(objattack, -NumPerAttack))) + geom_bar() +
scale_x_discrete(labels = function(x) str_wrap(x, width = 10)) +
xlab("") + ylab("# per Attack") + geom_text(aes(x = objattack,y = NumPerAttack,label = NumPerAttack),vjust = -0.25) +
ggtitle("Murder Rate per Location")
unique(Murder$ra)
unique(Murder$beat)
unique(Murder$beat)
unique(Murder$sector)
unique(Murder$division)
unique(Murder$district)
unique(Murder$taag)
unique(Murder$community)
unique(Murder$compethnicity)
unique(Murder$compsex)
unique(Murder$compage)
ggplot(Murder,aes(x = compage)) + geom_bar()
ggplot(Murder,aes(x = compage)) + geom_bar() + geom_line()
ggplot(Murder,aes(x = compage,color = servyr)) + geom_bar()
ggplot(Murder,aes(x = compage,facet = servyr)) + geom_bar()
ggplot(Murder,aes(x = compage)) + geom_bar() + facet_wrap(servyr)
ggplot(Murder,aes(x = compage)) + geom_bar() + facet_wrap(servyr)
ggplot(Murder,aes(x = compage)) + geom_bar() + facet_wrap(~ servyr)
ggplot(Murder,aes(x = compage)) + geom_histogram(bins = 10) + facet_wrap(~ servyr)
ggplot(Murder,aes(x = compage)) + geom_histogram(bins = 10) + facet_wrap(~ servyr) + scale_x_binned()
ggplot(Murder,aes(x = compsex)) + geom_histogram(bins = 3) + facet_wrap(~ servyr)
ggplot(Murder,aes(x = compsex)) + geom_histogram() + facet_wrap(~ servyr)
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr)
# Sex distrbution
Murder[,NumPerSexPerYear := .N,by = c("compsex","servyr")]
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear,label = NumPerSexPerYear),vjust = -0.25) +
ggtitle("Murder Rate per Sex")
Murder[,NumPerYear := .N,by = c("servyr")]
Murder[,PercentPerSexPerYear := .N/NumPerYear,by = c("compsex","servyr")]
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear,label = PercentPerSexPerYear),vjust = -0.25) +
ggtitle("Murder Rate per Sex")
format(0.1,"%")
ggtitle("Murder Rate per Sex")
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear),
label = format(PercentPerSexPerYear,digits = 2),
vjust = -0.25) +
ggtitle("Murder Rate per Sex")
format(100*Murder$PercentPerSexPerYear,digits = 2)
Murder$PercentPerSexPerYear <- format(100*Murder$PercentPerSexPerYear,digits = 0)
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear),
label = PercentPerSexPerYear,
vjust = -0.25) +
ggtitle("Murder Rate per Sex")
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear,
label = PercentPerSexPerYear),
vjust = -0.25) +
ggtitle("Murder Rate per Sex")
Murder[,PercentPerSexPerYear := .N/NumPerYear,by = c("compsex","servyr")]
Murder$PercentPerSexPerYear <- paste0(format(100*Murder$PercentPerSexPerYear,digits = 0),"%")
Murder[,NumPerYear := .N,by = c("servyr")]
Murder[,NumPerSexPerYear := .N,by = c("compsex","servyr")]
Murder[,PercentPerSexPerYear := .N/NumPerYear,by = c("compsex","servyr")]
Murder$PercentPerSexPerYear <- paste0(format(100*Murder$PercentPerSexPerYear,digits = 0),"%")
Murder[,PercentPerSexPerYear := .N/NumPerYear,by = c("compsex","servyr")]
100*Murder$PercentPerSexPerYear
Murder$PercentPerSexPerYear
Murder[,PercentPerSexPerYear := .N/NumPerYear,by = c("compsex","servyr")]
Murder$PercentPerSexPerYear
Murder$PercentPerSexPerYear <- NULL
Murder$PercentPerSexPerYear <- paste0(format(100*Murder$PercentPerSexPerYear,digits = 0),"%")
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear,
label = PercentPerSexPerYear),
vjust = -0.25) +
ggtitle("Murder Rate per Sex")
Murder$PercentPerSexPerYear
Murder$PercentPerSexPerYear <- NULL
Murder[,PercentPerSexPerYear := .N/NumPerYear,by = c("compsex","servyr")]
paste0(format(100*Murder$PercentPerSexPerYear,digits = 0),"%")
Murder$PercentPerSexPerYear <- paste0(format(100*Murder$PercentPerSexPerYear,digits = 0),"%")
ggplot(Murder,aes(x = compsex)) + geom_bar() + facet_wrap(~ servyr) +
geom_text(aes(x = compsex,y = NumPerSexPerYear,
label = PercentPerSexPerYear),
vjust = -0.25) +
ggtitle("Murder Rate per Sex")
ggplot(Murder[comprace == "Black" + compsex == "Male" + compage < 30,],
aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" + compsex == "Male" + compage < 30,],
aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" + compsex == "Male" + compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
unique(Murder$comprace)
ggplot(Murder[comprace == "White" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "White" & compsex == "Hispanic or Latino" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Female",],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage > 40,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 28,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage > 28,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 25,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 25,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Black" & compsex == "Female",],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "White" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage < 30,],aes(x = servyr)) + geom_bar()
ggplot(Murder[comprace == "Hispanic or Latino" & compsex == "Male" & compage > 30,],aes(x = servyr)) + geom_bar()
unique(Murder$comprace)
#
unique(Murder$nibrs_crime)
table(Murder$nibrs_crime)
unique(Murder$type)
unique(Murder$nibrs_crime_category)
unique(Murder$nibrs_crimeagainst)
unique(Murder$nibrs_code)
unique(Murder$nibrs_group)
unique(Murder$nibrs_type)
unique(Murder$family)
unique(Murder$hate)
unique(Murder$hatecrimedescriptn)
unique(Murder$gang)
table(Murder$gang)
table(Murder$involvement)
table(Murder$victimtype)
table(Murder$victimcond)
table(Murder$victiminjurydesc)
table(Murder$gang)
unique(Murder$vicpckg)
unique(Murder$drug)
table(Murder$drug)
table(Murder$geocoded_column)
unique(Murder$geocoded_column)
Murder$geocoded_column[1]
grepl("\n",Murder$geocoded_column[1])
grep("\n",Murder$geocoded_column[1])
grep("n(",Murder$geocoded_column[1])
grep("(",Murder$geocoded_column[1])
grep("n",Murder$geocoded_column[1])
grep("(",Murder$geocoded_column[1])
grep("()",Murder$geocoded_column[1])
grep("(",Murder$geocoded_column[1],fixed = TRUE)
grepl("(",Murder$geocoded_column[1],fixed = TRUE)
grep("(",Murder$geocoded_column[1],fixed = TRUE)
Murder$geocoded_column[1]
regexpr("(",Murder$geocoded_column[1],fixed = TRUE)
gregexpr("(",Murder$geocoded_column[1],fixed = TRUE)
nchar(Murder$geocoded_column[1])
regexpr("(",Murder$geocoded_column[1],fixed = TRUE)
regexpr("(",Murder$geocoded_column[1],fixed = TRUE)[1]
Murder[,LatLongStart = regexpr("(",geocoded_column,fixed = TRUE)[1] + 1]
Murder[,LatLongStart := regexpr("(",geocoded_column,fixed = TRUE)[1] + 1]
Murder[,LatLongEnd := regexpr(")",geocoded_column,fixed = TRUE)[1] - 1]
Murder[,LatLong := substr(geocoded_column,start = LatLongStart,end = LatLongEnd)]
Murder[,LatLong := substr(geocoded_column,start = LatLongStart,stop = LatLongEnd)]
Murder[,LatLong]
Murder$geocoded_column[682]
regexpr("(",Murder$geocoded_column[682],fixed = TRUE)
substr(Murder$geocoded_column[682],start = 41,stop = 48)
substr(Murder$geocoded_column[682],start = 42,stop = 480)
Murder[,.(LatLongStart,LatLongEnd,LatLong)]
regexpr("(",Murder$geocoded_column[4],fixed = TRUE)
Murder[,rowid := 1:.N]
Murder[,LatLongStart := regexpr("(",geocoded_column,fixed = TRUE)[1] + 1,by = rowid]
Murder[,LatLongEnd := regexpr(")",geocoded_column,fixed = TRUE)[1] - 1,by = rowid]
Murder[,LatLong := substr(geocoded_column,start = LatLongStart,stop = LatLongEnd)]
Murder[,.(LatLongStart,LatLongEnd,LatLong)]
Murder[,LatLongComma := regexpr(",",geocoded_column,fixed = TRUE)[1],by = rowid]
Murder[,Latitude := substr(geocoded_column,start = LatLongStart,stop = LatLongComma - 1)]
Murder[,Longitude := substr(geocoded_column,start = LatLongComma + 1,stop = LatLongEnd)]
Murder[,.(LatLongStart,LatLongEnd,LatLong,Latitude,Longitude)]
Murder[,LatLong := substr(geocoded_column,start = LatLongStart,stop = LatLongEnd)]
Murder[,LatLongComma := regexpr(",",LatLong,fixed = TRUE)[1],by = rowid]
Murder[,Latitude := substr(LatLong,start = 1,stop = LatLongComma - 1)]
Murder[,Longitude := substr(LatLong,start = LatLongComma + 1)]
Murder[,Longitude := substr(LatLong,start = LatLongComma + 1,stop = 1000)]
Murder[,.(LatLongStart,LatLongEnd,LatLong,Latitude,Longitude)]
plot(Murder$Longitude,Murder$Latitude)
ggplot2(Murder) + geom_point(aes(x = Longitude,y = Latitude)) + facet_wrap(~ servyr)
ggplot(Murder) + geom_point(aes(x = Longitude,y = Latitude)) + facet_wrap(~ servyr)
ggplot(Murder) + geom_point(aes(x = Longitude,y = Latitude,color = servyr))
ggplot(Murder) + geom_point(aes(x = Longitude,y = Latitude,color = as.factor(servyr)))
ggplot(Murder) + geom_point(aes(x = Longitude,y = Latitude,color = as.factor(servyr))) + facet_wrap(~ servyr) + ylab("")
ggplot(Murder) + geom_point(aes(x = Longitude,y = Latitude,color = as.factor(signal))) + facet_wrap(~ servyr) + ylab("")
ggplot(Murder[signal == "19 - Shooting",])
ggplot(Murder[signal == "19 - Shooting",]) + geom_point(aes(x = Longitude,y = Latitude,color = signal)) + facet_wrap(~ servyr) + ylab("")
ggplot(Murder[signal == "19 - Shooting",]) + geom_point(aes(x = Longitude,y = Latitude)) + facet_wrap(~ servyr) + ylab("")
ggplot(Murder[signal == "19 - Shooting",]) + geom_point(aes(x = Longitude,y = Latitude)) + facet_wrap(~ servyr)
ggplot(Murder[signal == "19 - Shooting",]) + geom_point(aes(x = Longitude,y = Latitude))
unique(Murder$signal)
ggplot(Murder[signal == "19 - SHOOTING",]) + geom_point(aes(x = Longitude,y = Latitude)) + facet_wrap(~ servyr) + ylab("")
ggplot(Murder[signal == "19 - SHOOTING",]) + geom_point(aes(x = Longitude,y = Latitude)) + facet_wrap(~ servyr) + ylab(NULL)
install.packages("sf")
install.packages("ggmap")
bikemap1 <- get_map(location = c(-122.080954, 36.971709), maptype = "terrain", source = "google", zoom = 14)
library(ggmap)
bikemap1 <- get_map(location = c(-122.080954, 36.971709), maptype = "terrain", source = "google", zoom = 14)
register_google
register_google()
register_google(key = "AIzaSyDKTY7qM26P0I3Lv4Xi196oP7-aVdVR2PU")
bikemap1 <- get_map(location = c(-122.080954, 36.971709), maptype = "terrain", source = "google", zoom = 14)
bikemap1 <- get_map(location = c(lon = -95.3632715, lat = 29.7632836),
maptype = "terrain", source = "google", zoom = 14)
map <- get_map(location = "texas", zoom = 6, source = "stamen")
(map <- get_map("orlando, florida"))
ggmap(map)
map <- get_map(location = "texas", zoom = 6, source = "stamen")
register_google(key = "AIzaSyDKTY7qM26P0I3Lv4Xi196oP7-aVdVR2PU")
library(ggmap)
bikemap1 <- get_map(location = c(lon = -95.3632715, lat = 29.7632836),
maptype = "terrain", source = "google", zoom = 14)
map <- get_map(location = "texas", zoom = 6, source = "stamen")
library(ggmap)
register_google(key = "AIzaSyDKTY7qM26P0I3Lv4Xi196oP7-aVdVR2PU")
map <- get_map(location = "texas", zoom = 6, source = "stamen")
ggmap_show_api_key()
google_key()
